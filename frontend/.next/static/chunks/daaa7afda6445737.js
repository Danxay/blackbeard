(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7670,e=>{"use strict";e.s(["default",0,function(){for(var e,t,s=0,r="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=function e(t){var s,r,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t)if(Array.isArray(t)){var l=t.length;for(s=0;s<l;s++)t[s]&&(r=e(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}(e))&&(r&&(r+=" "),r+=t);return r}])},75254,e=>{"use strict";var t=e.i(71645);let s=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,t.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:n="",children:c,iconNode:d,...o},x)=>(0,t.createElement)("svg",{ref:x,...r,width:a,height:a,stroke:e,strokeWidth:i?24*Number(l)/Number(a):l,className:s("lucide",n),...o},[...d.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(c)?c:[c]])),l=(e,r)=>{let l=(0,t.forwardRef)(({className:l,...i},n)=>(0,t.createElement)(a,{ref:n,iconNode:r,className:s(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,l),...i}));return l.displayName=`${e}`,l};e.s(["default",()=>l],75254)},18566,(e,t,s)=>{t.exports=e.r(76562)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],3116)},65250,e=>{"use strict";var t=e.i(71645);function s(){return null}function r(){return window.Telegram?.WebApp?window.Telegram.WebApp:null}function a(){return()=>{}}function l(){let e=(0,t.useSyncExternalStore)(a,r,s),l=(0,t.useRef)(!1);(0,t.useEffect)(()=>{if(e&&!l.current){l.current=!0,e.ready();try{e.expand()}catch(e){console.warn("Failed to expand WebApp:",e)}try{e.setHeaderColor("#221e10"),e.setBackgroundColor("#221e10")}catch(e){console.warn("Failed to set colors:",e)}}},[e]);let i=e?.initDataUnsafe?.user||null;return{tg:e,user:i,onClose:()=>{e?.close()},isReady:!!e,isMounted:!0}}e.s(["useTelegram",()=>l])},84614,e=>{"use strict";let t=(0,e.i(75254).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],84614)},87316,e=>{"use strict";let t=(0,e.i(75254).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},94351,e=>{"use strict";let t=(0,e.i(75254).default)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);e.s(["Home",()=>t],94351)},1736,e=>{"use strict";var t=e.i(43476),s=e.i(22016),r=e.i(18566),a=e.i(94351),l=e.i(87316),i=e.i(84614),n=e.i(7670);let c=[{href:"/",icon:a.Home,label:"Главная"},{href:"/bookings",icon:l.Calendar,label:"Записи"},{href:"/profile",icon:i.User,label:"Профиль"}];function d(){let e=(0,r.usePathname)();return(0,t.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 z-50 glass border-t border-border safe-bottom",children:(0,t.jsx)("div",{className:"flex items-center justify-around h-16 max-w-lg mx-auto",children:c.map(r=>{let a=e===r.href;return(0,t.jsxs)(s.default,{href:r.href,className:(0,n.default)("flex flex-col items-center justify-center w-20 h-full transition-all",a?"text-white":"text-text-muted hover:text-text-secondary"),children:[(0,t.jsx)(r.icon,{className:(0,n.default)("w-5 h-5 mb-1 transition-transform",a&&"scale-110"),strokeWidth:a?2.5:2}),(0,t.jsx)("span",{className:(0,n.default)("text-[10px] font-medium tracking-wide",a&&"font-semibold"),children:r.label}),a&&(0,t.jsx)("div",{className:"absolute top-0 w-12 h-0.5 bg-white rounded-full"})]},r.href)})})})}e.s(["default",()=>d])},33440,e=>{"use strict";var t=e.i(43476),s=e.i(1736),r=e.i(71645),a=e.i(7670),l=e.i(87316),i=e.i(75254);let n=(0,i.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),c=(0,i.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var d=e.i(3116),o=e.i(31278),x=e.i(22016),m=e.i(83599),u=e.i(54858),h=e.i(65250);function f(){let{bookings:e,isLoading:i,cancelBooking:f}=function(){let{user:e}=(0,h.useTelegram)(),t=e?.id,{data:s,error:r,isLoading:a,mutate:l}=(0,m.default)(t?`/api/bookings/user/${t}`:null,e=>(0,u.fetcher)(e),{revalidateOnFocus:!0,dedupingInterval:3e4}),i=async e=>{try{return await u.api.cancelBooking(e),l(),!0}catch(e){return console.error("Cancel booking error:",e),!1}};return{bookings:s||[],isLoading:a,isError:r,mutate:l,cancelBooking:i}}(),[b,p]=(0,r.useState)("upcoming"),[y,j]=(0,r.useState)(!1),[g,N]=(0,r.useState)(null),[w,v]=(0,r.useState)(!1),k=new Date,C=e.filter(e=>new Date(e.date)>=k&&"cancelled"!==e.status),A=e.filter(e=>new Date(e.date)<k||"cancelled"===e.status),M=async()=>{g&&(v(!0),await f(g),v(!1),j(!1))},S=e=>{let t=new Date(e);return{weekday:t.toLocaleDateString("ru-RU",{weekday:"long"}),dayMonth:t.toLocaleDateString("ru-RU",{day:"numeric",month:"short"}),month:t.toLocaleDateString("ru-RU",{month:"short"}),day:t.getDate()}};return i?(0,t.jsxs)("main",{className:"min-h-screen bg-bg pb-24",children:[(0,t.jsx)("div",{className:"sticky top-0 z-40 glass border-b border-border",children:(0,t.jsx)("div",{className:"flex items-center justify-between h-14 px-4",children:(0,t.jsx)("h1",{className:"text-base font-semibold text-white",children:"Записи"})})}),(0,t.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,t.jsx)(o.Loader2,{className:"w-8 h-8 text-text-muted animate-spin"})}),(0,t.jsx)(s.default,{})]}):(0,t.jsxs)("main",{className:"min-h-screen bg-bg pb-24",children:[(0,t.jsxs)("div",{className:"sticky top-0 z-40 glass border-b border-border",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between h-14 px-4",children:[(0,t.jsx)("h1",{className:"text-base font-semibold text-white",children:"Записи"}),(0,t.jsxs)(x.default,{href:"/services",className:"flex items-center gap-1 text-text-secondary text-sm",children:[(0,t.jsx)(n,{className:"w-4 h-4"}),"Новая"]})]}),(0,t.jsxs)("div",{className:"flex p-1 mx-4 mb-4 bg-bg-card rounded-xl",children:[(0,t.jsx)("button",{onClick:()=>p("upcoming"),className:(0,a.default)("flex-1 py-2 text-sm font-medium rounded-lg transition-colors","upcoming"===b?"bg-white text-black":"text-text-secondary"),children:"Предстоящие"}),(0,t.jsx)("button",{onClick:()=>p("history"),className:(0,a.default)("flex-1 py-2 text-sm font-medium rounded-lg transition-colors","history"===b?"bg-white text-black":"text-text-secondary"),children:"История"})]})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:["upcoming"===b&&(0,t.jsx)(t.Fragment,{children:0===C.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(l.Calendar,{className:"w-12 h-12 text-text-muted mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-text-secondary mb-4",children:"Нет предстоящих записей"}),(0,t.jsxs)(x.default,{href:"/services",className:"inline-flex items-center gap-2 px-6 py-3 bg-white text-black font-semibold rounded-xl",children:[(0,t.jsx)(n,{className:"w-4 h-4"}),"Записаться"]})]}):C.map(e=>{let s=S(e.date),r=e.total_price,a=e.total_duration;return(0,t.jsxs)("div",{className:"bg-bg-card rounded-2xl border border-border overflow-hidden",children:[(0,t.jsx)("div",{className:"p-4 border-b border-border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-text-muted text-xs uppercase tracking-wide",children:s.weekday}),(0,t.jsxs)("p",{className:"text-white text-xl font-semibold mt-0.5",children:[s.dayMonth,", ",e.time]})]}),(0,t.jsx)("div",{className:"px-2 py-1 bg-success/10 text-success text-xs font-medium rounded",children:"Подтверждено"})]})}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("img",{src:e.barber.image||"/placeholder.jpg",alt:e.barber.name,className:"w-12 h-12 rounded-xl object-cover"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-white font-medium truncate",children:e.barber.name}),(0,t.jsx)("p",{className:"text-text-secondary text-sm truncate",children:e.services.map(e=>e.name).join(", ")}),(0,t.jsxs)("p",{className:"text-text-muted text-xs flex items-center gap-1 mt-1",children:[(0,t.jsx)(d.Clock,{className:"w-3 h-3"}),a," мин"]})]}),(0,t.jsxs)("p",{className:"text-white font-semibold",children:[r," ₽"]})]})}),(0,t.jsxs)("div",{className:"flex border-t border-border",children:[(0,t.jsx)("button",{onClick:()=>{N(e.id),j(!0)},className:"flex-1 py-4 text-error text-sm font-medium border-r border-border active:bg-error/5",children:"Отменить"}),(0,t.jsx)(x.default,{href:"/book/date",className:"flex-1 py-4 text-white text-sm font-medium text-center active:bg-white/5",children:"Перенести"})]})]},e.id)})}),"history"===b&&(0,t.jsx)("div",{className:"space-y-2",children:0===A.length?(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsx)("p",{className:"text-text-secondary",children:"История пуста"})}):A.map(e=>{let s=S(e.date);return(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-bg-card rounded-2xl border border-border",children:[(0,t.jsxs)("div",{className:"w-12 h-12 rounded-xl bg-bg-elevated flex flex-col items-center justify-center",children:[(0,t.jsx)("span",{className:"text-[10px] text-text-muted uppercase",children:s.month}),(0,t.jsx)("span",{className:"text-white font-semibold",children:s.day})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-white font-medium truncate",children:e.services.map(e=>e.name).join(", ")}),(0,t.jsx)("p",{className:"text-text-muted text-sm",children:e.barber.name})]}),(0,t.jsx)(x.default,{href:"/services",className:"text-accent text-sm font-medium",children:"Повторить"})]},e.id)})})]}),y&&(0,t.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/60",onClick:()=>j(!1),children:(0,t.jsxs)("div",{className:"bg-bg-card rounded-t-3xl w-full max-w-lg border-t border-border animate-slide-up p-6",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-error/10 flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(c,{className:"w-6 h-6 text-error"})}),(0,t.jsx)("h3",{className:"text-white font-semibold text-lg mb-2",children:"Отменить запись?"}),(0,t.jsx)("p",{className:"text-text-secondary text-sm",children:"Это действие нельзя отменить"})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>j(!1),className:"flex-1 py-4 bg-bg-elevated text-white font-medium rounded-2xl",disabled:w,children:"Назад"}),(0,t.jsx)("button",{onClick:M,className:"flex-1 py-4 bg-error text-white font-medium rounded-2xl flex items-center justify-center gap-2",disabled:w,children:w?(0,t.jsx)(o.Loader2,{className:"w-5 h-5 animate-spin"}):"Отменить"})]})]})}),(0,t.jsx)(s.default,{})]})}e.s(["default",()=>f],33440)}]);