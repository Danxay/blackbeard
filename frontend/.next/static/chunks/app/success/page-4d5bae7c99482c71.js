(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{886:(e,t,s)=>{Promise.resolve().then(s.bind(s,6936))},6936:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(3365),r=s(3689),i=s(9262),n=s(7339),c=s(7637),l=s(5338),o=s(2865),d=s(4377),u=s(7906);function m(){let{selectedBarber:e,selectedServices:t,selectedDate:s,selectedTime:m,getTotalPrice:p,getTotalDuration:h,reset:b}=(0,d.m)(),x=p(),y=h(),v=s?s.toLocaleDateString("ru",{day:"numeric",month:"short"}):"";return(0,a.jsxs)("main",{className:"min-h-screen bg-bg flex flex-col",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[(0,a.jsx)(o.P.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15},className:"w-20 h-20 rounded-full bg-success/10 flex items-center justify-center mb-6",children:(0,a.jsx)(r.A,{className:"w-10 h-10 text-success",strokeWidth:3})}),(0,a.jsx)(o.P.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-2xl font-semibold text-white mb-2",children:"Записано!"}),(0,a.jsxs)(o.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-text-secondary mb-8",children:["Ждём вас в ",u.DH.name]}),e&&t.length>0&&(0,a.jsxs)(o.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"w-full bg-bg-card rounded-2xl border border-border p-4 text-left",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 pb-4 border-b border-border",children:[(0,a.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 rounded-xl object-cover"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-white font-medium truncate",children:t.map(e=>e.name).join(", ")}),(0,a.jsx)("p",{className:"text-text-muted text-sm",children:e.name})]}),(0,a.jsxs)("p",{className:"text-white font-semibold",children:[x," ₽"]})]}),(0,a.jsxs)("div",{className:"flex pt-4 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.A,{className:"w-4 h-4 text-text-secondary"}),(0,a.jsx)("span",{className:"text-white text-sm",children:v})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.A,{className:"w-4 h-4 text-text-secondary"}),(0,a.jsx)("span",{className:"text-white text-sm",children:m})]})]})]})]}),(0,a.jsxs)("div",{className:"p-4 pb-6 space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>{if(!s||!m)return;let[a,r]=m.split(":").map(Number),i=new Date(s);i.setHours(a,r,0,0);let n=new Date(i);n.setMinutes(n.getMinutes()+y);let c="".concat(t.map(e=>e.name).join(", ")," — ").concat(u.DH.name),l=e?"Мастер: ".concat(e.name,"\n").concat(u.DH.address.full):u.DH.address.full,o=e=>e.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",d="https://calendar.google.com/calendar/render?action=TEMPLATE&text=".concat(encodeURIComponent(c),"&dates=").concat(o(i),"/").concat(o(n),"&details=").concat(encodeURIComponent(l),"&location=").concat(encodeURIComponent(u.DH.address.full));window.open(d,"_blank")},className:"flex items-center justify-center gap-2 w-full bg-white text-black py-4 rounded-2xl font-semibold active:scale-[0.98] transition-transform",children:[(0,a.jsx)(i.A,{className:"w-5 h-5"}),"Добавить в календарь"]}),(0,a.jsxs)(l.default,{href:"/",onClick:()=>{b()},className:"flex items-center justify-center gap-2 w-full bg-bg-card text-white py-4 rounded-2xl font-medium border border-border",children:[(0,a.jsx)(c.A,{className:"w-5 h-5"}),"На главную"]})]})]})}},7906:(e,t,s)=>{"use strict";s.d(t,{DH:()=>a,TF:()=>r,VZ:()=>i,Wk:()=>n});let a={name:"Black Beard",tagline:"Премиум барбершоп",address:{street:"ул. Тверская, 15",city:"Москва",metro:"м. Пушкинская",short:"Тверская 15, Пушкинская",full:"Москва, ул. Тверская, 15 (м. Пушкинская)"},phone:"+7 (495) 123-45-67",phoneClean:"+74951234567",workHours:{weekdays:"10:00 - 22:00",saturday:"10:00 - 21:00",sunday:"11:00 - 20:00"},mapsUrl:"https://yandex.ru/maps/-/CDuOzK~V",mapImage:"https://static-maps.yandex.ru/1.x/?ll=37.606628,55.763969&z=16&l=map&size=450,300&pt=37.606628,55.763969,pm2rdm",schedule:[{day:"Понедельник",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Вторник",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Среда",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Четверг",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Пятница",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Суббота",hours:"10:00 – 21:00",open:"10:00",close:"21:00",isToday:!1},{day:"Воскресенье",hours:"11:00 – 20:00",open:"11:00",close:"20:00",isToday:!1}],social:{instagram:"@blackbeard_moscow",telegram:"@blackbeard_bot",vk:"vk.com/blackbeard_moscow"}};function r(){let e=new Date().getDay(),t=a.schedule[0===e?6:e-1];return{open:t.open,close:t.close,hours:t.hours}}function i(){let e=new Date,t=r(),[s,a]=t.open.split(":").map(Number),[i,n]=t.close.split(":").map(Number),c=60*e.getHours()+e.getMinutes();return c>=60*s+a&&c<60*i+n}function n(e){let t=new Date;return t.setDate(t.getDate()+e),t}},4377:(e,t,s)=>{"use strict";s.d(t,{m:()=>l});var a=s(9117),r=s(3547);class i{async request(e,t){let s=await fetch("".concat(this.baseUrl).concat(e),{...t,headers:{"Content-Type":"application/json",...null==t?void 0:t.headers}});if(!s.ok)throw Error("API Error: ".concat(s.status));return s.json()}async getServices(){return this.request("/api/services")}async getPopularServices(){return this.request("/api/services/popular")}async getBarbers(){return this.request("/api/barbers")}async getBarber(e){return this.request("/api/barbers/".concat(e))}async createBooking(e){return this.request("/api/bookings",{method:"POST",body:JSON.stringify(e)})}async getUserBookings(e){return this.request("/api/bookings/user/".concat(e))}async cancelBooking(e){return this.request("/api/bookings/".concat(e),{method:"DELETE"})}async validateInitData(e){return this.request("/api/auth/validate",{method:"POST",body:JSON.stringify({init_data:e})})}constructor(){this.baseUrl="http://localhost:8000"}}let n=new i,c={selectedServices:[],selectedBarber:null,selectedDate:null,selectedTime:null,entryPoint:null,isSubmitting:!1},l=(0,a.v)()((0,r.Zr)((e,t)=>({...c,setServices:t=>e({selectedServices:t}),addService:t=>e(e=>({selectedServices:[...e.selectedServices,t]})),removeService:t=>e(e=>({selectedServices:e.selectedServices.filter(e=>e.id!==t)})),toggleService:e=>{t().selectedServices.some(t=>t.id===e.id)?t().removeService(e.id):t().addService(e)},setBarber:t=>e({selectedBarber:t}),setDate:t=>e({selectedDate:t}),setTime:t=>e({selectedTime:t}),setEntryPoint:t=>e({entryPoint:t}),getTotalPrice:()=>t().selectedServices.reduce((e,t)=>e+t.price,0),getTotalDuration:()=>t().selectedServices.reduce((e,t)=>e+t.duration,0),submitBooking:async()=>{let s=t(),a=function(){var e,t,s;return(null===(s=window.Telegram)||void 0===s?void 0:null===(t=s.WebApp)||void 0===t?void 0:null===(e=t.initDataUnsafe)||void 0===e?void 0:e.user)||null}();if(!s.selectedBarber||!s.selectedDate||!s.selectedTime)return!1;e({isSubmitting:!0});try{return await n.createBooking({telegram_id:(null==a?void 0:a.id)||0,chat_id:function(){var e,t,s;let a=null===(s=window.Telegram)||void 0===s?void 0:null===(t=s.WebApp)||void 0===t?void 0:null===(e=t.initDataUnsafe)||void 0===e?void 0:e.user;return(null==a?void 0:a.id)||0}(),first_name:(null==a?void 0:a.first_name)||"Guest",username:null==a?void 0:a.username,barber_id:parseInt(s.selectedBarber.id),service_ids:s.selectedServices.map(e=>parseInt(e.id)),date:s.selectedDate.toISOString(),time:s.selectedTime,total_price:s.getTotalPrice(),total_duration:s.getTotalDuration()}),!0}catch(e){return console.error("Booking error:",e),!1}finally{e({isSubmitting:!1})}},reset:()=>e(c),isServiceSelected:e=>t().selectedServices.some(t=>t.id===e)}),{name:"booking-storage",partialize:e=>({selectedServices:e.selectedServices,selectedBarber:e.selectedBarber})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[608,865,677,347,239,358],()=>t(886)),_N_E=e.O()}]);