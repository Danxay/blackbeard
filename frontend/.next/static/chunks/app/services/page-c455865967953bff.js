(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{9921:(e,t,r)=>{Promise.resolve().then(r.bind(r,6070))},6070:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(3365),i=r(7142),a=r(1521),c=r(913),n=r(7339),l=r(3689),o=r(6871),d=r(5338),u=r(9714),m=r(4377);let b=[{key:"all",label:"Все"},{key:"haircut",label:"Стрижки"},{key:"beard",label:"Борода"},{key:"complex",label:"Комплексы"}];function h(){let{selectedServices:e,toggleService:t,isServiceSelected:r,getTotalPrice:h,getTotalDuration:x,setEntryPoint:p,selectedBarber:v}=(0,m.m)(),[g,f]=a.useState("all"),y=(0,a.useMemo)(()=>"all"===g?u.$:u.$.filter(e=>e.category===g),[g]),j=h(),w=x();return a.useEffect(()=>{v||p("services")},[]),(0,s.jsxs)("main",{className:"min-h-screen bg-bg",children:[(0,s.jsx)(i.A,{title:"Услуги"}),(0,s.jsx)("div",{className:"sticky top-14 z-30 bg-bg/95 backdrop-blur-sm border-b border-border",children:(0,s.jsx)("div",{className:"flex gap-2 p-4 overflow-x-auto no-scrollbar",children:b.map(e=>(0,s.jsx)("button",{onClick:()=>f(e.key),className:(0,c.A)("px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all",g===e.key?"bg-white text-black":"bg-bg-card text-text-secondary border border-border"),children:e.label},e.key))})}),(0,s.jsx)("div",{className:"p-4 pb-40 space-y-2",children:y.map(e=>{let i=r(e.id),a=e.icon;return(0,s.jsxs)("div",{onClick:()=>t(e),className:(0,c.A)("flex items-center gap-4 p-4 rounded-2xl border cursor-pointer transition-all active:scale-[0.99]",i?"bg-white/5 border-white/30":"bg-bg-card border-border"),children:[(0,s.jsx)("div",{className:(0,c.A)("w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 transition-colors",i?"bg-white/10":"bg-bg-elevated"),children:(0,s.jsx)(a,{className:(0,c.A)("w-5 h-5 transition-colors",i?"text-white":"text-text-secondary")})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h3",{className:"text-white font-medium",children:e.name}),e.popular&&(0,s.jsx)("span",{className:"text-[10px] bg-accent/20 text-accent px-1.5 py-0.5 rounded",children:"Хит"})]}),(0,s.jsx)("p",{className:"text-text-muted text-sm mt-0.5 line-clamp-1",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,s.jsxs)("span",{className:"text-text-muted text-xs flex items-center gap-1",children:[(0,s.jsx)(n.A,{className:"w-3 h-3"}),e.duration," мин"]}),(0,s.jsxs)("span",{className:"text-white font-semibold text-sm",children:[e.price," ₽"]})]})]}),(0,s.jsx)("div",{className:(0,c.A)("w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all flex-shrink-0",i?"bg-white border-white":"border-text-muted"),children:i&&(0,s.jsx)(l.A,{className:"w-4 h-4 text-black",strokeWidth:3})})]},e.id)})}),(0,s.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 p-4 pb-6 glass border-t border-border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3 px-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-text-muted text-xs",children:0===e.length?"Выберите услуги":"Выбрано: ".concat(e.length)}),w>0&&(0,s.jsxs)("p",{className:"text-text-secondary text-sm flex items-center gap-1",children:[(0,s.jsx)(n.A,{className:"w-3.5 h-3.5"}),w<60?"".concat(w," мин"):"".concat(Math.floor(w/60)," ч ").concat(w%60," мин")]})]}),j>0&&(0,s.jsxs)("p",{className:"text-white text-2xl font-semibold",children:[j," ₽"]})]}),(0,s.jsxs)(d.default,{href:e.length>0?v?"/book/date":"/book/barber":"#",className:(0,c.A)("flex items-center justify-between w-full py-4 px-6 rounded-2xl font-semibold transition-all",e.length>0?"bg-white text-black active:scale-[0.98]":"bg-bg-card text-text-muted cursor-not-allowed"),onClick:t=>0===e.length&&t.preventDefault(),children:[(0,s.jsx)("span",{children:v?"Выбрать время":"Выбрать мастера"}),(0,s.jsx)(o.A,{className:"w-5 h-5"})]})]})]})}},7142:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(3365),i=r(5840),a=r(5278);function c(e){let{title:t,showBack:r=!0}=e,c=(0,i.useRouter)();return(0,s.jsx)("header",{className:"sticky top-0 z-40 glass border-b border-border",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-14 px-4",children:[r?(0,s.jsx)("button",{onClick:()=>c.back(),className:"flex items-center justify-center w-10 h-10 -ml-2 rounded-full hover:bg-bg-hover text-white transition-colors",children:(0,s.jsx)(a.A,{className:"w-5 h-5"})}):(0,s.jsx)("div",{className:"w-10"}),(0,s.jsx)("h1",{className:"text-base font-semibold text-white tracking-tight",children:t}),(0,s.jsx)("div",{className:"w-10"})]})})}},9714:(e,t,r)=>{"use strict";r.d(t,{$:()=>u});var s=r(7932),i=r(588),a=r(7979),c=r(5928),n=r(8418),l=r(9863),o=r(1180),d=r(7569);let u=[{id:"classic-haircut",name:"Классическая стрижка",description:"Стрижка машинкой и ножницами, укладка",price:2500,duration:45,category:"haircut",icon:s.A,popular:!0},{id:"fade",name:"Фейд",description:"Плавный переход от кожи",price:2800,duration:50,category:"haircut",icon:i.A},{id:"crop",name:"Кроп",description:"Короткая текстурная стрижка",price:2500,duration:40,category:"haircut",icon:a.A},{id:"beard-trim",name:"Моделирование бороды",description:"Стрижка и оформление бороды",price:1500,duration:30,category:"beard",icon:c.A},{id:"royal-shave",name:"Королевское бритьё",description:"Опасная бритва, горячие полотенца",price:2e3,duration:40,category:"beard",icon:n.A,popular:!0},{id:"haircut-beard-combo",name:"Стрижка + борода",description:"Полный уход: стрижка и оформление бороды",price:3500,duration:75,category:"complex",icon:l.A,popular:!0},{id:"father-son",name:"Отец и сын",description:"Две стрижки по специальной цене",price:4e3,duration:90,category:"complex",icon:s.A},{id:"hair-wash",name:"Мытьё и укладка",description:"Мытьё головы и стайлинг",price:800,duration:20,category:"additional",icon:o.A},{id:"hair-coloring",name:"Камуфляж седины",description:"Лёгкое тонирование",price:1500,duration:30,category:"additional",icon:d.A}]},4377:(e,t,r)=>{"use strict";r.d(t,{m:()=>l});var s=r(9117),i=r(3547);class a{async request(e,t){let r=await fetch("".concat(this.baseUrl).concat(e),{...t,headers:{"Content-Type":"application/json",...null==t?void 0:t.headers}});if(!r.ok)throw Error("API Error: ".concat(r.status));return r.json()}async getServices(){return this.request("/api/services")}async getPopularServices(){return this.request("/api/services/popular")}async getBarbers(){return this.request("/api/barbers")}async getBarber(e){return this.request("/api/barbers/".concat(e))}async createBooking(e){return this.request("/api/bookings",{method:"POST",body:JSON.stringify(e)})}async getUserBookings(e){return this.request("/api/bookings/user/".concat(e))}async cancelBooking(e){return this.request("/api/bookings/".concat(e),{method:"DELETE"})}async validateInitData(e){return this.request("/api/auth/validate",{method:"POST",body:JSON.stringify({init_data:e})})}constructor(){this.baseUrl="http://localhost:8000"}}let c=new a,n={selectedServices:[],selectedBarber:null,selectedDate:null,selectedTime:null,entryPoint:null,isSubmitting:!1},l=(0,s.v)()((0,i.Zr)((e,t)=>({...n,setServices:t=>e({selectedServices:t}),addService:t=>e(e=>({selectedServices:[...e.selectedServices,t]})),removeService:t=>e(e=>({selectedServices:e.selectedServices.filter(e=>e.id!==t)})),toggleService:e=>{t().selectedServices.some(t=>t.id===e.id)?t().removeService(e.id):t().addService(e)},setBarber:t=>e({selectedBarber:t}),setDate:t=>e({selectedDate:t}),setTime:t=>e({selectedTime:t}),setEntryPoint:t=>e({entryPoint:t}),getTotalPrice:()=>t().selectedServices.reduce((e,t)=>e+t.price,0),getTotalDuration:()=>t().selectedServices.reduce((e,t)=>e+t.duration,0),submitBooking:async()=>{let r=t(),s=function(){var e,t,r;return(null===(r=window.Telegram)||void 0===r?void 0:null===(t=r.WebApp)||void 0===t?void 0:null===(e=t.initDataUnsafe)||void 0===e?void 0:e.user)||null}();if(!r.selectedBarber||!r.selectedDate||!r.selectedTime)return!1;e({isSubmitting:!0});try{return await c.createBooking({telegram_id:(null==s?void 0:s.id)||0,chat_id:function(){var e,t,r;let s=null===(r=window.Telegram)||void 0===r?void 0:null===(t=r.WebApp)||void 0===t?void 0:null===(e=t.initDataUnsafe)||void 0===e?void 0:e.user;return(null==s?void 0:s.id)||0}(),first_name:(null==s?void 0:s.first_name)||"Guest",username:null==s?void 0:s.username,barber_id:parseInt(r.selectedBarber.id),service_ids:r.selectedServices.map(e=>parseInt(e.id)),date:r.selectedDate.toISOString(),time:r.selectedTime,total_price:r.getTotalPrice(),total_duration:r.getTotalDuration()}),!0}catch(e){return console.error("Booking error:",e),!1}finally{e({isSubmitting:!1})}},reset:()=>e(n),isServiceSelected:e=>t().selectedServices.some(t=>t.id===e)}),{name:"booking-storage",partialize:e=>({selectedServices:e.selectedServices,selectedBarber:e.selectedBarber})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[608,930,347,239,358],()=>t(9921)),_N_E=e.O()}]);