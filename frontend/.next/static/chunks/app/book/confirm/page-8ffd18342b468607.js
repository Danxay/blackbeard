(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[237],{504:(e,s,t)=>{Promise.resolve().then(t.bind(t,7227))},7227:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var r=t(3365),a=t(7142),i=t(2648),l=t(7932),c=t(9262),n=t(7339),d=t(7642),o=t(6871),m=t(5338),u=t(4377),x=t(7906),h=t(5840),b=t(1521);function p(){let e=(0,h.useRouter)(),{selectedBarber:s,selectedServices:t,selectedDate:p,selectedTime:v,getTotalPrice:g,getTotalDuration:j}=(0,u.m)(),f=g(),y=j();if((0,b.useEffect)(()=>{s&&0!==t.length&&v||e.push("/services")},[]),!s||0===t.length)return null;let N=p?p.toLocaleDateString("ru",{day:"numeric",month:"short",weekday:"short"}):"";return(0,r.jsxs)("main",{className:"min-h-screen bg-bg",children:[(0,r.jsx)(a.A,{title:"Подтверждение"}),(0,r.jsxs)("div",{className:"p-4 pb-44 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-bg-card rounded-2xl border border-border p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-text-muted text-xs mb-3",children:[(0,r.jsx)(i.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:"Мастер"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("img",{src:s.image,alt:s.name,className:"w-12 h-12 rounded-xl object-cover"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:s.name}),(0,r.jsx)("p",{className:"text-text-muted text-sm",children:s.role})]})]})]}),(0,r.jsxs)("div",{className:"bg-bg-card rounded-2xl border border-border p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-text-muted text-xs mb-3",children:[(0,r.jsx)(l.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:"Услуги"})]}),(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white text-sm",children:e.name}),(0,r.jsxs)("p",{className:"text-text-muted text-xs",children:[e.duration," мин"]})]}),(0,r.jsxs)("p",{className:"text-white font-medium",children:[e.price," ₽"]})]},e.id))})]}),(0,r.jsx)("div",{className:"bg-bg-card rounded-2xl border border-border p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-text-muted text-xs mb-2",children:[(0,r.jsx)(c.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:"Дата"})]}),(0,r.jsx)("p",{className:"text-white font-medium",children:N})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-text-muted text-xs mb-2",children:[(0,r.jsx)(n.A,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:"Время"})]}),(0,r.jsx)("p",{className:"text-white font-medium",children:v})]})]})}),(0,r.jsx)(m.default,{href:"/location",className:"block bg-bg-card rounded-2xl border border-border p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-bg-elevated flex items-center justify-center",children:(0,r.jsx)(d.A,{className:"w-5 h-5 text-text-secondary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:x.DH.name}),(0,r.jsx)("p",{className:"text-text-muted text-sm",children:x.DH.address.short})]})]}),(0,r.jsx)(o.A,{className:"w-4 h-4 text-text-muted"})]})})]}),(0,r.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 p-4 pb-6 glass border-t border-border",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3 px-1",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-text-muted text-xs",children:"Итого"}),(0,r.jsxs)("p",{className:"text-text-secondary text-sm flex items-center gap-1",children:[(0,r.jsx)(n.A,{className:"w-3.5 h-3.5"}),y," мин"]})]}),(0,r.jsxs)("p",{className:"text-white text-2xl font-semibold",children:[f," ₽"]})]}),(0,r.jsxs)(m.default,{href:"/success",className:"flex items-center justify-between w-full bg-white text-black py-4 px-6 rounded-2xl font-semibold active:scale-[0.98] transition-transform",children:[(0,r.jsx)("span",{children:"Подтвердить"}),(0,r.jsx)(o.A,{className:"w-5 h-5"})]}),(0,r.jsx)("p",{className:"text-text-muted text-xs text-center mt-3",children:"Оплата на месте \xb7 Отмена за 2 часа бесплатно"})]})]})}},7142:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});var r=t(3365),a=t(5840),i=t(5278);function l(e){let{title:s,showBack:t=!0}=e,l=(0,a.useRouter)();return(0,r.jsx)("header",{className:"sticky top-0 z-40 glass border-b border-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-14 px-4",children:[t?(0,r.jsx)("button",{onClick:()=>l.back(),className:"flex items-center justify-center w-10 h-10 -ml-2 rounded-full hover:bg-bg-hover text-white transition-colors",children:(0,r.jsx)(i.A,{className:"w-5 h-5"})}):(0,r.jsx)("div",{className:"w-10"}),(0,r.jsx)("h1",{className:"text-base font-semibold text-white tracking-tight",children:s}),(0,r.jsx)("div",{className:"w-10"})]})})}},7906:(e,s,t)=>{"use strict";t.d(s,{DH:()=>r,TF:()=>a,VZ:()=>i,Wk:()=>l});let r={name:"Black Beard",tagline:"Премиум барбершоп",address:{street:"ул. Тверская, 15",city:"Москва",metro:"м. Пушкинская",short:"Тверская 15, Пушкинская",full:"Москва, ул. Тверская, 15 (м. Пушкинская)"},phone:"+7 (495) 123-45-67",phoneClean:"+74951234567",workHours:{weekdays:"10:00 - 22:00",saturday:"10:00 - 21:00",sunday:"11:00 - 20:00"},mapsUrl:"https://yandex.ru/maps/-/CDuOzK~V",mapImage:"https://static-maps.yandex.ru/1.x/?ll=37.606628,55.763969&z=16&l=map&size=450,300&pt=37.606628,55.763969,pm2rdm",schedule:[{day:"Понедельник",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Вторник",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Среда",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Четверг",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Пятница",hours:"10:00 – 22:00",open:"10:00",close:"22:00",isToday:!1},{day:"Суббота",hours:"10:00 – 21:00",open:"10:00",close:"21:00",isToday:!1},{day:"Воскресенье",hours:"11:00 – 20:00",open:"11:00",close:"20:00",isToday:!1}],social:{instagram:"@blackbeard_moscow",telegram:"@blackbeard_bot",vk:"vk.com/blackbeard_moscow"}};function a(){let e=new Date().getDay(),s=r.schedule[0===e?6:e-1];return{open:s.open,close:s.close,hours:s.hours}}function i(){let e=new Date,s=a(),[t,r]=s.open.split(":").map(Number),[i,l]=s.close.split(":").map(Number),c=60*e.getHours()+e.getMinutes();return c>=60*t+r&&c<60*i+l}function l(e){let s=new Date;return s.setDate(s.getDate()+e),s}},4377:(e,s,t)=>{"use strict";t.d(s,{m:()=>n});var r=t(9117),a=t(3547);class i{async request(e,s){let t=await fetch("".concat(this.baseUrl).concat(e),{...s,headers:{"Content-Type":"application/json",...null==s?void 0:s.headers}});if(!t.ok)throw Error("API Error: ".concat(t.status));return t.json()}async getServices(){return this.request("/api/services")}async getPopularServices(){return this.request("/api/services/popular")}async getBarbers(){return this.request("/api/barbers")}async getBarber(e){return this.request("/api/barbers/".concat(e))}async createBooking(e){return this.request("/api/bookings",{method:"POST",body:JSON.stringify(e)})}async getUserBookings(e){return this.request("/api/bookings/user/".concat(e))}async cancelBooking(e){return this.request("/api/bookings/".concat(e),{method:"DELETE"})}async validateInitData(e){return this.request("/api/auth/validate",{method:"POST",body:JSON.stringify({init_data:e})})}constructor(){this.baseUrl="http://localhost:8000"}}let l=new i,c={selectedServices:[],selectedBarber:null,selectedDate:null,selectedTime:null,entryPoint:null,isSubmitting:!1},n=(0,r.v)()((0,a.Zr)((e,s)=>({...c,setServices:s=>e({selectedServices:s}),addService:s=>e(e=>({selectedServices:[...e.selectedServices,s]})),removeService:s=>e(e=>({selectedServices:e.selectedServices.filter(e=>e.id!==s)})),toggleService:e=>{s().selectedServices.some(s=>s.id===e.id)?s().removeService(e.id):s().addService(e)},setBarber:s=>e({selectedBarber:s}),setDate:s=>e({selectedDate:s}),setTime:s=>e({selectedTime:s}),setEntryPoint:s=>e({entryPoint:s}),getTotalPrice:()=>s().selectedServices.reduce((e,s)=>e+s.price,0),getTotalDuration:()=>s().selectedServices.reduce((e,s)=>e+s.duration,0),submitBooking:async()=>{let t=s(),r=function(){var e,s,t;return(null===(t=window.Telegram)||void 0===t?void 0:null===(s=t.WebApp)||void 0===s?void 0:null===(e=s.initDataUnsafe)||void 0===e?void 0:e.user)||null}();if(!t.selectedBarber||!t.selectedDate||!t.selectedTime)return!1;e({isSubmitting:!0});try{return await l.createBooking({telegram_id:(null==r?void 0:r.id)||0,chat_id:function(){var e,s,t;let r=null===(t=window.Telegram)||void 0===t?void 0:null===(s=t.WebApp)||void 0===s?void 0:null===(e=s.initDataUnsafe)||void 0===e?void 0:e.user;return(null==r?void 0:r.id)||0}(),first_name:(null==r?void 0:r.first_name)||"Guest",username:null==r?void 0:r.username,barber_id:parseInt(t.selectedBarber.id),service_ids:t.selectedServices.map(e=>parseInt(e.id)),date:t.selectedDate.toISOString(),time:t.selectedTime,total_price:t.getTotalPrice(),total_duration:t.getTotalDuration()}),!0}catch(e){return console.error("Booking error:",e),!1}finally{e({isSubmitting:!1})}},reset:()=>e(c),isServiceSelected:e=>s().selectedServices.some(s=>s.id===e)}),{name:"booking-storage",partialize:e=>({selectedServices:e.selectedServices,selectedBarber:e.selectedBarber})}))}},e=>{var s=s=>e(e.s=s);e.O(0,[608,7,347,239,358],()=>s(504)),_N_E=e.O()}]);